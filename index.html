<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>VrindaOne Premiere League - Live Scores</title>
    <link href="https://fonts.googleapis.com/css2?family=Syne:wght@400;600;700;800&family=JetBrains+Mono:wght@400;500&display=swap" rel="stylesheet">
    <link rel="stylesheet" href="style.css">
        <link rel="icon" href="VPL_logo.jpeg" type="image/x-icon"> 

</head>
<body>
    <header class="header">
        <div class="container">
            <div class="logo">
                <h1>üèè VrindaOne Premiere League</h1>
            </div>
            
            <button id="mobileMenuToggle" class="mobile-menu-toggle" type="button" title="Toggle mobile menu">
                <span></span>
                <span></span>
                <span></span>
            </button>
            
            <nav class="nav" id="mainNav">
                <button class="nav-btn active" data-tab="live" title="View live matches">Live Scores</button>
                <button class="nav-btn" data-tab="points" title="View points table">Points Table</button>
                <button class="nav-btn" data-tab="stats" title="View tournament statistics">Stats & Rankings</button>
                <button class="nav-btn" data-tab="previous" title="View past matches">Previous Matches</button>
                <button class="nav-btn" data-tab="viewteams" title="View all teams">Teams</button>
                <button class="nav-btn admin-only hidden" data-tab="teams" title="Manage teams">Manage Teams</button>
                <button class="nav-btn admin-only hidden" data-tab="matches" title="Manage matches">Manage Matches</button>
                <button class="nav-btn admin-only hidden" data-tab="scoring" title="Score a match">Score Match</button>
                <button id="loginBtn" class="login-btn" title="Login as administrator">Admin Login</button>
                <button id="logoutBtn" class="logout-btn hidden" title="Logout">Logout</button>
            </nav>
        </div>
    </header>

    <div id="refreshIndicator" class="refresh-indicator">
        Auto-refreshing in <span id="refreshTimer">30</span>s
    </div>

    <main class="main-content">
        <div id="loginModal" class="modal hidden">
            <div class="modal-content">
                <span class="close-modal" title="Close modal">&times;</span>
                <h2>Admin Login</h2>
                <form id="loginForm">
                    <div class="form-group">
                        <label for="loginEmail">Email</label>
                        <input type="email" id="loginEmail" placeholder="Enter admin email" title="Enter your registered email address" required>
                    </div>
                    <div class="form-group">
                        <label for="loginPassword">Password</label>
                        <input type="password" id="loginPassword" placeholder="Enter password" title="Enter your password" required>
                    </div>
                    <button type="submit" class="btn btn-primary" title="Click to login">Login</button>
                    <p class="form-message" id="loginMessage"></p>
                </form>
            </div>
        </div>

        <section id="liveTab" class="tab-content active">
            <div class="container">
                <h2 class="section-title">Live Matches</h2>
                <div id="liveMatchesList" class="matches-grid">
                    </div>

                <div id="matchDetails" class="match-details hidden">
                    <div class="match-header">
                        <h3 id="matchTitle">Match Title</h3>
                        <span id="matchStatus" class="match-status"></span>
                    </div>
                    
                    <div class="scoreboard">
                        <div class="team-score">
                            <h4 id="team1Name">Team 1</h4>
                            <div class="score-display">
                                <span id="team1Score" class="score">0/0</span>
                                <span id="team1Overs" class="overs">(0.0 ov)</span>
                            </div>
                        </div>
                        <div class="vs">VS</div>
                        <div class="team-score">
                            <h4 id="team2Name">Team 2</h4>
                            <div class="score-display">
                                <span id="team2Score" class="score">0/0</span>
                                <span id="team2Overs" class="overs">(0.0 ov)</span>
                            </div>
                        </div>
                    </div>

                    <div class="current-partnership">
                        <h4>Current Partnership</h4>
                        <div id="partnershipDetails" class="partnership-info"></div>
                    </div>

                    <div class="ball-by-ball">
                        <h4>Ball by Ball Commentary
                            <button id="loadCommentaryBtn" class="btn btn-secondary">Show Commentary ‚ñº</button>
                        </h4>
                        <div id="ballCommentary" class="commentary-list hidden"></div>
                    </div>

                    <div class="batting-scorecard">
                        <h4>Batting Scorecard</h4>
                        <table id="battingTable" class="scorecard-table">
                            <thead>
                                <tr>
                                    <th>Batsman</th>
                                    <th>R</th>
                                    <th>B</th>
                                    <th>4s</th>
                                    <th>6s</th>
                                    <th>SR</th>
                                    <th>Status</th>
                                </tr>
                            </thead>
                            <tbody id="battingTableBody"></tbody>
                            <tfoot id="battingTableFooter"></tfoot>
                        </table>
                    </div>

                    <div class="bowling-scorecard">
                        <h4>Bowling Scorecard</h4>
                        <table id="bowlingTable" class="scorecard-table">
                            <thead>
                                <tr>
                                    <th>Bowler</th>
                                    <th>O</th>
                                    <th>M</th>
                                    <th>R</th>
                                    <th>W</th>
                                    <th>Ext</th>
                                    <th>Econ</th>
                                </tr>
                            </thead>
                            <tbody id="bowlingTableBody"></tbody>
                        </table>
                    </div>
                </div>
            </div>
        </section>

        <section id="pointsTab" class="tab-content">
            <div class="container">
                <h2 class="section-title">Tournament Points Table</h2>
                <div class="points-table-wrapper">
                    <table class="points-table">
                        <thead>
                            <tr>
                                <th>Pos</th>
                                <th>Team</th>
                                <th>P</th>
                                <th>W</th>
                                <th>L</th>
                                <th>T</th>
                                <th>NRR</th>
                                <th>Pts</th>
                            </tr>
                        </thead>
                        <tbody id="pointsTableBody"></tbody>
                    </table>
                </div>
            </div>
        </section>

        <section id="statsTab" class="tab-content">
            <div class="container">
                <h2 class="section-title">Tournament Statistics</h2>
                
                <div class="mvp-section">
                    <div class="mvp-card">
                        <h3>üëë Man of the Series Leader</h3>
                        <div class="mvp-name" id="mvpName">Calculating...</div>
                        <div class="mvp-points" id="mvpPoints"></div>
                    </div>
                </div>

                <div class="stats-grid">
                    <div class="stats-box">
                        <h3>üü† Best Batsman (Most Runs)</h3>
                        <table class="stats-table">
                            <thead>
                                <tr>
                                    <th>Rank</th>
                                    <th>Player</th>
                                    <th>Team</th>
                                    <th>Runs</th>
                                </tr>
                            </thead>
                            <tbody id="battingRankingsBody">
                                </tbody>
                        </table>
                    </div>

                    <div class="stats-box">
                        <h3>üü£ Best Bowler (Most Wickets)</h3>
                        <table class="stats-table">
                            <thead>
                                <tr>
                                    <th>Rank</th>
                                    <th>Player</th>
                                    <th>Team</th>
                                    <th>Wickets</th>
                                </tr>
                            </thead>
                            <tbody id="bowlingRankingsBody">
                                </tbody>
                        </table>
                    </div>
                </div>
            </div>
        </section>

        <section id="previousTab" class="tab-content">
            <div class="container">
                <h2 class="section-title">Previous Matches</h2>
                <div id="previousMatchesList" class="matches-grid"></div>
                
                <div id="previousMatchDetails" class="match-details hidden">
                    <div class="match-header">
                        <h3 id="prevMatchTitle"></h3>
                        <span class="match-status completed">COMPLETED</span>
                    </div>
                    <div class="match-result">
                        <h3 id="prevMatchResult"></h3>
                    </div>

                    <!-- Scoreboard summary -->
                    <div class="scoreboard">
                        <div class="team-score">
                            <h4 id="prevTeam1Name">Team 1</h4>
                            <div class="score-display">
                                <span id="prevTeam1Score" class="score">0/0</span>
                                <span id="prevTeam1Overs" class="overs">(0.0 ov)</span>
                            </div>
                        </div>
                        <div class="vs">VS</div>
                        <div class="team-score">
                            <h4 id="prevTeam2Name">Team 2</h4>
                            <div class="score-display">
                                <span id="prevTeam2Score" class="score">0/0</span>
                                <span id="prevTeam2Overs" class="overs">(0.0 ov)</span>
                            </div>
                        </div>
                    </div>

                    <!-- Awards summary -->
                    <div class="awards-row">
                        <div class="award-item">
                            <div class="award-item-label">üèÜ Man of the Match</div>
                            <div id="prevMotm">-</div>
                        </div>
                        <div class="award-item">
                            <div class="award-item-label">üèè Best Batsman</div>
                            <div id="prevBestBat">-</div>
                        </div>
                        <div class="award-item">
                            <div class="award-item-label">üé≥ Best Bowler</div>
                            <div id="prevBestBowl">-</div>
                        </div>
                    </div>
                    
                    <div id="prevMatchScorecards">
                        <div class="batting-scorecard">
                            <h4>Innings 1 Batting</h4>
                            <table class="scorecard-table">
                                <thead><tr><th>Batsman</th><th>R</th><th>B</th><th>4s</th><th>6s</th><th>SR</th><th>Status</th></tr></thead>
                                <tbody id="prevInnings1BattingBody"></tbody>
                                <tfoot id="prevInnings1BattingFooter"></tfoot>
                            </table>
                        </div>
                        <div class="bowling-scorecard">
                            <h4>Innings 1 Bowling</h4>
                            <table class="scorecard-table">
                                <thead><tr><th>Bowler</th><th>O</th><th>M</th><th>R</th><th>W</th><th>Ext</th><th>Econ</th></tr></thead>
                                <tbody id="prevInnings1BowlingBody"></tbody>
                            </table>
                        </div>
                        <div class="batting-scorecard">
                            <h4>Innings 2 Batting</h4>
                            <table class="scorecard-table">
                                <thead><tr><th>Batsman</th><th>R</th><th>B</th><th>4s</th><th>6s</th><th>SR</th><th>Status</th></tr></thead>
                                <tbody id="prevInnings2BattingBody"></tbody>
                                <tfoot id="prevInnings2BattingFooter"></tfoot>
                            </table>
                        </div>
                        <div class="bowling-scorecard">
                            <h4>Innings 2 Bowling</h4>
                            <table class="scorecard-table">
                                <thead><tr><th>Bowler</th><th>O</th><th>M</th><th>R</th><th>W</th><th>Ext</th><th>Econ</th></tr></thead>
                                <tbody id="prevInnings2BowlingBody"></tbody>
                            </table>
                        </div>
                    </div>
                </div>
            </div>
        </section>

        <!-- PUBLIC TEAMS TAB (Read-Only for Everyone) -->
        <section id="viewteamsTab" class="tab-content">
            <div class="container">
                <h2 class="section-title">Tournament Teams</h2>
                
                <div id="publicTeamsList" class="public-teams-grid">
                    <!-- Teams will be loaded here by JavaScript -->
                </div>
            </div>
        </section>

        <section id="teamsTab" class="tab-content admin-only hidden">
            <div class="container">
                <h2 class="section-title">Manage Teams</h2>
                
                <div class="admin-panel">
                    <div class="panel-section">
                        <h3>Add New Team</h3>
                        <form id="addTeamForm">
                            <div class="form-group">
                                <label for="teamName">Team Name</label>
                                <input type="text" id="teamName" placeholder="e.g., Mumbai Indians" required>
                            </div>
                            <div class="form-group">
                                <label for="teamShortName">Team Short Name (3 letters)</label>
                                <input type="text" id="teamShortName" maxlength="3" placeholder="e.g., MI" required>
                            </div>
                            <button type="submit" class="btn btn-primary">Add Team</button>
                        </form>
                    </div>

                    <div class="panel-section">
                        <h3>Add Player to Team</h3>
                        <form id="addPlayerForm">
                            <div class="form-group">
                                <label for="playerTeamSelect">Select Team</label>
                                <select id="playerTeamSelect" required>
                                    <option value="">-- Select Team --</option>
                                </select>
                            </div>
                            <div class="form-group">
                                <label for="playerName">Player Name</label>
                                <input type="text" id="playerName" placeholder="e.g., Virat Kohli" required>
                            </div>
                            <div class="form-group">
                                <label for="playerRole">Player Role</label>
                                <select id="playerRole" required>
                                    <option value="Batsman">Batsman</option>
                                    <option value="Bowler">Bowler</option>
                                    <option value="All-rounder">All-rounder</option>
                                    <option value="Wicket-keeper">Wicket-keeper</option>
                                </select>
                            </div>
                            <button type="submit" class="btn btn-primary">Add Player</button>
                        </form>
                    </div>

                    <div class="panel-section">
                        <h3>Existing Teams</h3>
                        <div id="teamsList" class="teams-list"></div>
                    </div>
                </div>
            </div>
        </section>

        <section id="matchesTab" class="tab-content admin-only hidden">
            <div class="container">
                <h2 class="section-title">Manage Matches</h2>
                
                <div class="admin-panel">
                    <div class="panel-section">
                        <h3>Create New Match</h3>
                        <form id="addMatchForm">
                            <div class="form-group">
                                <label for="matchTeam1">Team 1</label>
                                <select id="matchTeam1" required>
                                    <option value="">-- Select Team 1 --</option>
                                </select>
                            </div>
                            <div class="form-group">
                                <label for="matchTeam2">Team 2</label>
                                <select id="matchTeam2" required>
                                    <option value="">-- Select Team 2 --</option>
                                </select>
                            </div>
                            <div class="form-group">
                                <label for="matchOvers">Number of Overs</label>
                                <input type="number" id="matchOvers" min="1" max="50" placeholder="e.g., 20" required>
                            </div>
                            <div class="form-group">
                                <label for="matchDateTime">Match Date & Time</label>
                                <input type="datetime-local" id="matchDateTime" required>
                            </div>
                            <div class="form-group">
                                <label for="matchVenue">Venue</label>
                                <input type="text" id="matchVenue" placeholder="e.g., Wankhede Stadium" required>
                            </div>
                            <button type="submit" class="btn btn-primary">Create Match</button>
                        </form>
                    </div>

                    <div class="panel-section">
                        <h3>All Matches (Live, Upcoming & Completed)</h3>
                        <div id="matchesList" class="matches-list">
                            </div>
                    </div>
                </div>
            </div>
        </section>

        <section id="scoringTab" class="tab-content admin-only hidden">
            <div class="container">
                <h2 class="section-title">Live Scoring</h2>
                
                <div class="scoring-panel">
                    <div class="match-selector">
                        <label for="scoringMatchSelect">Select Match to Score</label>
                        <select id="scoringMatchSelect">
                            <option value="">-- Select Match --</option>
                        </select>
                    </div>

                    <div id="scoringInterface" class="scoring-interface hidden">
                        
                        <div id="tossSelection" class="toss-selection">
                            <h3>Toss Details</h3>
                            <div class="toss-form">
                                <div class="form-group">
                                    <label for="tossWinnerSelect">Who won the toss?</label>
                                    <select id="tossWinnerSelect" required>
                                        <option value="">-- Select Toss Winner --</option>
                                    </select>
                                </div>
                                <div class="form-group">
                                    <label for="tossDecisionSelect">Toss Decision</label>
                                    <select id="tossDecisionSelect" required>
                                        <option value="">-- Select Decision --</option>
                                        <option value="bat">Chose to Bat</option>
                                        <option value="bowl">Chose to Bowl</option>
                                    </select>
                                </div>
                                <button id="confirmTossBtn" class="btn btn-success">Confirm Toss</button>
                            </div>
                        </div>

                        <div id="tossInfoDisplay" class="toss-info hidden">
                            <p id="tossInfoText"></p>
                        </div>

                        <div class="scoring-header">
                            <h3 id="scoringMatchTitle"></h3>
                            <div class="match-controls">
                                <button id="startInningsBtn" class="btn btn-success hidden">Start Innings</button>
                                <button id="endInningsBtn" class="btn btn-warning hidden">End Innings</button>
                                <button id="endMatchBtn" class="btn btn-danger hidden">End Match</button>
                            </div>
                        </div>

                        <div class="current-score-display">
                            <div class="batting-team-info">
                                <h4 id="scoringBattingTeam"></h4>
                                <div class="big-score">
                                    <span id="scoringScore">0/0</span>
                                    <span id="scoringOvers" class="overs-small">(0.0)</span>
                                </div>
                            </div>
                        </div>

                        <div id="batsmenSelection" class="batsmen-selection hidden">
                            <h4>Select Opening Batsmen</h4>
                            <div class="form-group">
                                <label for="strikerSelect">Striker</label>
                                <select id="strikerSelect" required>
                                    <option value="">-- Select Striker --</option>
                                </select>
                            </div>
                            <div class="form-group">
                                <label for="nonStrikerSelect">Non-Striker</label>
                                <select id="nonStrikerSelect" required>
                                    <option value="">-- Select Non-Striker --</option>
                                </select>
                            </div>
                            <button id="confirmBatsmenBtn" class="btn btn-primary">Confirm</button>
                        </div>

                        <div id="bowlerSelection" class="bowler-selection hidden">
                            <h4>Select Bowler</h4>
                            <div class="form-group">
                                <label for="bowlerSelect">Bowler</label>
                                <select id="bowlerSelect" required>
                                    <option value="">-- Select Bowler --</option>
                                </select>
                            </div>
                            <button id="confirmBowlerBtn" class="btn btn-primary">Confirm</button>
                        </div>

                        <div id="currentPlayers" class="current-players hidden">
                            <div class="player-card striker">
                                <div class="player-label">Striker *</div>
                                <div class="player-name" id="currentStriker"></div>
                                <div class="player-stats" id="strikerStats">0(0)</div>
                            </div>
                            <div class="player-card">
                                <div class="player-label">Non-Striker</div>
                                <div class="player-name" id="currentNonStriker"></div>
                                <div class="player-stats" id="nonStrikerStats">0(0)</div>
                            </div>
                            <div class="player-card bowler">
                                <div class="player-label">Bowler</div>
                                <div class="player-name" id="currentBowler"></div>
                                <div class="player-stats" id="bowlerStats">0-0 (0.0)</div>
                            </div>
                        </div>

                        <div id="scoringControls" class="scoring-controls hidden">
                            <div class="runs-buttons">
                                <button class="run-btn" data-runs="0">0</button>
                                <button class="run-btn" data-runs="1">1</button>
                                <button class="run-btn" data-runs="2">2</button>
                                <button class="run-btn" data-runs="3">3</button>
                                <button class="run-btn" data-runs="4">4</button>
                                <button class="run-btn" data-runs="6">6</button>
                            </div>

                            <div class="extras-buttons">
                                <button class="extra-btn" data-extra="wide">Wide</button>
                                <button class="extra-btn" data-extra="noball">No Ball</button>
                                <button class="extra-btn" data-extra="bye">Bye</button>
                                <button class="extra-btn" data-extra="legbye">Leg Bye</button>
                            </div>

                            <div class="action-buttons">
                                <button id="wicketBtn" class="btn btn-danger">Wicket</button>
                                <button id="strikeChangeBtn" class="btn btn-secondary">Change Strike</button>
                                <button id="changeBowlerBtn" class="btn btn-info">Change Bowler</button>
                                <button id="undoBtn" class="btn btn-warning">Undo Last Ball</button>
                            </div>
                        </div>

                        <div id="wicketModal" class="modal-overlay hidden">
                            <div class="modal-box">
                                <h3>Wicket Details</h3>
                                <form id="wicketForm">
                                    <div class="form-group">
                                        <label for="wicketBatsmanSelect">Batsman Out</label>
                                        <select id="wicketBatsmanSelect" required>
                                            <option value="">-- Select --</option>
                                        </select>
                                    </div>
                                    <div class="form-group">
                                        <label for="wicketType">Dismissal Type</label>
                                        <select id="wicketType" required>
                                            <option value="Bowled">Bowled</option>
                                            <option value="Caught">Caught</option>
                                            <option value="LBW">LBW</option>
                                            <option value="Run Out">Run Out</option>
                                            <option value="Stumped">Stumped</option>
                                            <option value="Hit Wicket">Hit Wicket</option>
                                        </select>
                                    </div>
                                    <div class="form-group" id="fielderGroup">
                                        <label for="fielderSelect">Fielder (if caught/run out)</label>
                                        <select id="fielderSelect">
                                            <option value="">-- Select Fielder --</option>
                                        </select>
                                    </div>
                                    <div class="form-group">
                                        <label for="newBatsmanSelect">New Batsman</label>
                                        <select id="newBatsmanSelect" required>
                                            <option value="">-- Select --</option>
                                        </select>
                                    </div>
                                    <div class="modal-buttons">
                                        <button type="submit" class="btn btn-primary">Confirm Wicket</button>
                                        <button type="button" id="cancelWicketBtn" class="btn btn-secondary">Cancel</button>
                                    </div>
                                </form>
                            </div>
                        </div>

                        <div class="this-over">
                            <h4>This Over</h4>
                            <div id="thisOverBalls" class="over-balls"></div>
                        </div>

                        <div class="recent-commentary">
                            <h4>Recent Balls</h4>
                            <div id="scoringCommentary" class="commentary-list"></div>
                        </div>
                    </div>
                </div>
            </div>
        </section>
    </main>

    <footer class="footer">
        <div class="container">
            <p>&copy; 2024 VrindaOne Premiere League. All rights reserved.</p>
        </div>
    </footer>

    <script src="https://www.gstatic.com/firebasejs/10.7.1/firebase-app-compat.js"></script>
    <script src="https://www.gstatic.com/firebasejs/10.7.1/firebase-auth-compat.js"></script>
    <script src="https://www.gstatic.com/firebasejs/10.7.1/firebase-firestore-compat.js"></script>
    
    <script src="app.js"></script>
</body>
</html>